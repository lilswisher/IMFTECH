<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IMF Image Editor</title>
  <style>
    /* General reset and styling */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background-color: black;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      font-family: Arial, sans-serif;
    }

    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    h1 {
      text-transform: lowercase;
      margin-bottom: 20px;
    }

    /* Back arrow styling */
    #backArrow {
      font-size: 1.5em;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      position: absolute;
      top: 20px;
      left: 20px;
      display: none; /* Hidden initially */
      transition: color 0.3s;
    }

    #backArrow:hover {
      color: #e0e0e0;
    }

    /* Hide the actual file input */
    #upload {
      display: none;
    }

    /* Custom label styled as a button */
    .upload-label {
      padding: 15px 30px;
      font-size: 1.5em;
      font-weight: bold;
      color: black;
      background-color: white;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.3s;
      text-align: center;
    }

    .upload-label:hover {
      background-color: #e0e0e0;
      transform: scale(1.05);
    }

    .upload-label:active {
      background-color: #c0c0c0;
    }

    /* Social Media Icons styling */
    .social-media {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }

    .social-media img {
      width: 40px;
      height: 40px;
      cursor: pointer;
      transition: transform 0.3s;
    }

    .social-media img:hover {
      transform: scale(1.1);
    }

    #editorContainer {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: 40px;
      margin-top: 20px;
    }

    #editor {
      position: relative;
      width: 100%;
      max-width: 80vw;
      height: auto;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    #uploadedImage {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: none;
      transition: filter 0.3s;
    }

    #overlayText {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 3em;
      font-style: normal;
      color: white;
      display: none;
      pointer-events: none;
      transition: transform 0.3s;
    }

    .button-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
      position: relative;
      align-items: flex-start;
    }

    button {
      width: 150px;
      padding: 10px;
      font-size: 1em;
      background-color: black;
      color: white;
      border: 2px solid white;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background-color: white;
      color: black;
    }

    .stencil-options {
      display: flex;
      flex-direction: column;
      gap: 5px;
      position: absolute;
      top: 100%;
      left: 0;
      padding: 10px;
      background-color: black;
      border: 2px solid white;
      border-radius: 8px;
      max-height: 0;
      opacity: 0;
      overflow-y: auto;
      transition: max-height 0.3s ease, opacity 0.3s ease;
    }

    .stencil-options.show {
      max-height: 500px;
      opacity: 1;
    }

    .slider-container {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 15px;
      width: 220px;
      margin-right: 25px;
    }

    .slider-container label {
      font-size: 1em;
      margin-bottom: 5px;
    }

    .slider-control {
      display: flex;
      align-items: center;
      gap: 5px;
      justify-content: flex-end;
    }

    .slider-container input[type="range"], .slider-container select {
      width: 160px;
    }

    .slider-container, #downloadBtn, #stencilGroup {
      display: none;
    }

    #downloadBtn {
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <!-- Back Arrow in Top Left -->
  <button id="backArrow">‚Üê</button>

  <div class="container">
    <h1>imformant.tech</h1>
    
    <!-- Custom Upload Button -->
    <label for="upload" class="upload-label">UPLOAD</label>
    <input type="file" id="upload" accept="image/*">

    <!-- Social Media Icons -->
    <div class="social-media" id="socialMediaLinks">
      <a href="https://warpcast.com/~/channel/imf" target="_blank">
        <img src="farcaster-icon.png" alt="farcaster-icon">
      </a>
      <a href="https://x.com/intlmemefund?s=21" target="_blank">
        <img src="twitter-icon.png" alt="Twitter">
      </a>
      <a href="https://imf.bz" target="_blank">
        <img src="imf-icon.png" alt="imfwebsite">
      </a>
    </div>

    <div id="editorContainer">
      
      <div class="slider-container" id="sliderControls">
        <div class="slider-control">
          <label for="xSlider">X</label>
          <input type="range" id="xSlider" min="0" max="100" value="50">
        </div>
        <div class="slider-control">
          <label for="ySlider">Y</label>
          <input type="range" id="ySlider" min="0" max="100" value="50">
        </div>
        <div class="slider-control">
          <label for="sizeSlider">Size</label>
          <input type="range" id="sizeSlider" min="1" max="5" value="3" step="0.1">
        </div>
        <div class="slider-control">
          <label for="rotationSlider">Rotation</label>
          <input type="range" id="rotationSlider" min="0" max="360" value="0">
        </div>
        <div class="slider-control">
          <label for="filterSelect">Filter</label>
          <select id="filterSelect">
            <option value="none">None</option>
            <option value="mosaic">Blur</option>
            <option value="blackWhite">Grayscale</option>
          </select>
        </div>
      </div>

      <div id="editor">
        <img id="uploadedImage" alt="Upload an image to edit" />
        <div id="overlayText">IMF</div>
      </div>

      <div class="button-group" id="stencilGroup">
        <button id="stencilButton" onclick="toggleStencils()">Stencils</button>
        <div class="stencil-options" id="stencilOptions">
          <button id="italicizeButton" onclick="toggleItalic()">Italicize</button>
          <button onclick="setOverlayText('IMF')">IMF</button>
          <button onclick="setOverlayText('MEME HARDER')">MEME HARDER</button>
          <button onclick="setOverlayText('IMFORMANT')">IMFORMANT</button>
          <button onclick="setOverlayText('MEME ON A MISSION')">MEME ON A MISSION</button>
          <button onclick="setOverlayText('pre-rich')">pre-rich</button>
          <button onclick="setOverlayText('$MONEY')">$MONEY</button>
          <button onclick="setOverlayText('$IMF')">$IMF</button>
          <button onclick="setOverlayText('Gmoney')">Gmoney</button>
          <button onclick="setOverlayText('COINSORTIUM')">COINSORTIUM</button>
        </div>
      </div>
    </div>

    <!-- Download Button -->
    <button id="downloadBtn">Download</button>
  </div>

  <!-- JavaScript logic for image handling, positioning, filters, and download -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    document.getElementById('upload').addEventListener('change', handleImageUpload);
    document.getElementById('downloadBtn').addEventListener('click', downloadImage);
    document.getElementById('xSlider').addEventListener('input', updateOverlayPosition);
    document.getElementById('ySlider').addEventListener('input', updateOverlayPosition);
    document.getElementById('sizeSlider').addEventListener('input', updateOverlaySize);
    document.getElementById('rotationSlider').addEventListener('input', updateOverlayRotation);
    document.getElementById('filterSelect').addEventListener('change', applyFilter);

    function handleImageUpload(event) {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function(e) {
        const imgElement = document.getElementById('uploadedImage');
        imgElement.src = e.target.result;
        imgElement.style.display = 'block';

        // Show necessary buttons after image upload
        document.querySelector('.upload-label').style.display = 'none';
        document.getElementById('backArrow').style.display = 'inline';
        document.getElementById('stencilGroup').style.display = 'flex';
        document.getElementById('downloadBtn').style.display = 'block';
        document.getElementById('sliderControls').style.display = 'flex';

        // Hide social media icons after upload
        document.getElementById('socialMediaLinks').style.display = 'none';

        // Reset overlay text and sliders
        const overlayText = document.getElementById('overlayText');
        overlayText.style.display = 'none';
        document.getElementById('xSlider').value = 50;
        document.getElementById('ySlider').value = 50;
        document.getElementById('sizeSlider').value = 3;
        document.getElementById('rotationSlider').value = 0;
        overlayText.style.left = '50%';
        overlayText.style.top = '50%';
      };
      reader.readAsDataURL(file);
    }

    function toggleStencils() {
      const stencilOptions = document.getElementById('stencilOptions');
      stencilOptions.classList.toggle('show');
    }

    function setOverlayText(text) {
      const overlayText = document.getElementById('overlayText');
      overlayText.innerText = text;
      overlayText.style.display = 'block';
    }

    function toggleItalic() {
      const overlayText = document.getElementById('overlayText');
      const italicizeButton = document.getElementById('italicizeButton');
      
      if (overlayText.style.fontStyle === 'italic') {
        overlayText.style.fontStyle = 'normal';
        italicizeButton.style.backgroundColor = 'black';
        italicizeButton.style.color = 'white';
      } else {
        overlayText.style.fontStyle = 'italic';
        italicizeButton.style.backgroundColor = 'white';
        italicizeButton.style.color = 'black';
      }
    }

    function updateOverlayPosition() {
      const overlayText = document.getElementById('overlayText');
      const xSlider = document.getElementById('xSlider').value;
      const ySlider = document.getElementById('ySlider').value;

      overlayText.style.left = `${xSlider}%`;
      overlayText.style.top = `${ySlider}%`;
    }

    function updateOverlaySize() {
      const overlayText = document.getElementById('overlayText');
      const size = document.getElementById('sizeSlider').value;
      overlayText.style.transform = `translate(-50%, -50%) scale(${size}) rotate(${document.getElementById('rotationSlider').value}deg)`;
    }

    function updateOverlayRotation() {
      const overlayText = document.getElementById('overlayText');
      const rotation = document.getElementById('rotationSlider').value;
      overlayText.style.transform = `translate(-50%, -50%) scale(${document.getElementById('sizeSlider').value}) rotate(${rotation}deg)`;
    }

    function applyFilter() {
      const filterSelect = document.getElementById('filterSelect').value;
      const imgElement = document.getElementById('uploadedImage');

      if (filterSelect === 'mosaic') {
        imgElement.style.filter = 'blur(5px)';
      } else if (filterSelect === 'blackWhite') {
        imgElement.style.filter = 'grayscale(100%)';
      } else {
        imgElement.style.filter = 'none';
      }
    }

    function downloadImage() {
      const editor = document.getElementById('editor');
      html2canvas(editor, { backgroundColor: null }).then(canvas => {
        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/png');
        link.download = 'edited-image.png';
        link.click();
      });
    }

    function resetEditor() {
      document.getElementById('uploadedImage').style.display = 'none';
      document.querySelector('.upload-label').style.display = 'inline-block';
      document.getElementById('backArrow').style.display = 'none';
      document.getElementById('stencilGroup').style.display = 'none';
      document.getElementById('downloadBtn').style.display = 'none';
      document.getElementById('sliderControls').style.display = 'none';
      document.getElementById('overlayText').style.display = 'none';
      document.getElementById('upload').value = '';

      // Show social media icons again on reset
      document.getElementById('socialMediaLinks').style.display = 'flex';
    }

    document.getElementById('backArrow').addEventListener('click', resetEditor);
  </script>
</body>
</html>
